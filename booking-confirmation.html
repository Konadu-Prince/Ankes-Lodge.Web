<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Booking confirmation for Ankes Lodge guest house in Abesim, Sunyani, Ghana. Your reservation details and next steps.">
    <meta name="keywords" content="Ankes Lodge, booking confirmation, reservation, guest house, Sunyani, Abesim, Ghana">
    <meta name="author" content="Ankes Lodge">
    <meta name="robots" content="noindex, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:url" content="https://ankes-lodge.onrender.com/booking-confirmation.html">
    <meta property="og:title" content="Booking Confirmation - Ankes Lodge">
    <meta property="og:description" content="Your booking at Ankes Lodge has been received. View your reservation details and next steps.">
    <meta property="og:image" content="https://ankes-lodge.onrender.com/orangeLogo.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary">
    <meta property="twitter:url" content="https://ankes-lodge.onrender.com/booking-confirmation.html">
    <meta property="twitter:title" content="Booking Confirmation - Ankes Lodge">
    <meta property="twitter:description" content="Your booking at Ankes Lodge has been received. View your reservation details and next steps.">
    <meta property="twitter:image" content="https://ankes-lodge.onrender.com/orangeLogo.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://ankes-lodge.onrender.com/booking-confirmation.html">
    
    <title>Booking Confirmation - Ankes Lodge</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="orangeLogo.png" type="image/png">
</head>
<body>
    <!-- Schema.org structured data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Reservation",
      "reservationId": "Booking Confirmation",
      "reservationStatus": "http://schema.org/ReservationPending",
      "underName": {
        "@type": "Person",
        "name": "Customer"
      },
      "reservationFor": {
        "@type": "Hotel",
        "name": "Ankes Lodge",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "Sunyani Abesim - After Olistar School - Nkran Kese Road, Opposite Omega Water Production Centre",
          "addressLocality": "Abesim",
          "addressRegion": "Sunyani",
          "postalCode": "BS-0484-4619",
          "addressCountry": "GH"
        }
      },
      "description": "Booking confirmation for Ankes Lodge guest house in Abesim, Sunyani, Ghana.",
      "url": "https://ankes-lodge.onrender.com/booking-confirmation.html"
    }
    </script>
    <!-- Header Section -->
    <header>
        <div class="container">
            <div class="logo">
                <img src="orangeLogo.png" alt="Ankes Lodge Logo">
                <h1>Ankes Lodge</h1>
            </div>
            <div class="menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html#home">Home</a></li>
                    <li><a href="index.html#rooms">Rooms</a></li>
                    <li><a href="index.html#facilities">Facilities</a></li>
                    <li><a href="index.html#location">Location</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                    <li><a href="index.html#booking" class="btn-primary">Book Now</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Confirmation Section -->
    <section class="confirmation">
        <div class="container">
            <div class="confirmation-content">
                <div class="confirmation-icon">✓</div>
                <h2>Booking Request Submitted!</h2>
                <p>Thank you for choosing Ankes Lodge. Your booking request has been successfully submitted.</p>
                
                <div class="booking-details">
                    <h3>Booking Details</h3>
                    <div class="detail-item">
                        <span class="label">Booking ID:</span>
                        <span id="booking-id">-</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Name:</span>
                        <span id="customer-name">-</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Check-in Date:</span>
                        <span id="checkin-date">-</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Check-out Date:</span>
                        <span id="checkout-date">-</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Room Type:</span>
                        <span id="room-type">-</span>
                    </div>
                </div>
                
                <div class="confirmation-message">
                    <p>A confirmation email has been sent to your email address with these details.</p>
                    <p>Your reservation is pending payment. Please complete your payment to confirm your booking.</p>
                </div>
                
                <div class="payment-options">
                    <h3>Payment Options</h3>
                    <p>Required Amount: ₵<span id="required-amount">0.00</span></p>
                    <div class="payment-buttons">
                        <button class="btn-primary" onclick="initiatePayment()">Pay Now Securely</button>
                        <button class="btn-secondary" onclick="initiateDonation()">Make a Donation</button>
                    </div>
                </div>
                
                <div class="confirmation-actions">
                    <a href="index.html#booking" class="btn-primary">Make Another Booking</a>
                    <a href="index.html" class="btn-secondary">Back to Home</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="orangeLogo.png" alt="Ankes Lodge Logo">
                    <h3>Ankes Lodge</h3>
                </div>
                
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html#home">Home</a></li>
                        <li><a href="index.html#rooms">Rooms</a></li>
                        <li><a href="index.html#facilities">Facilities</a></li>
                        <li><a href="index.html#booking">Booking</a></li>
                        <li><a href="index.html#contact">Contact</a></li>
                    </ul>
                </div>
                
                <div class="social-media">
                    <h4>Follow Us</h4>
                    <div class="social-links">
                        <p><a href="https://vm.tiktok.com/ZMHwSn9khM96S-gSAVf/" target="_blank" rel="noopener">TikTok</a></p>
                        <p><a href="#" target="_blank" rel="noopener">Facebook</a></p>
                        <p><a href="#" target="_blank" rel="noopener">Instagram</a></p>
                        <p><a href="#" target="_blank" rel="noopener">Twitter</a></p>
                    </div>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2025 Ankes Lodge. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Get booking details from URL parameters
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const bookingId = urlParams.get('id');
            const name = urlParams.get('name');
            const checkin = urlParams.get('checkin');
            const checkout = urlParams.get('checkout');
            const roomType = urlParams.get('room');
            
            // Display booking details
            if (bookingId) {
                document.getElementById('booking-id').textContent = bookingId;
            }
            
            if (name) {
                document.getElementById('customer-name').textContent = name;
            }
            
            if (checkin) {
                document.getElementById('checkin-date').textContent = checkin;
            }
            
            if (checkout) {
                document.getElementById('checkout-date').textContent = checkout;
            }
            
            if (roomType) {
                const roomTypes = {
                    'executive': 'Executive Room (₵299/night)',
                    'regular': 'Regular Bedroom (₵199/night)',
                    'full-house': 'Full House (Custom Pricing)'
                };
                document.getElementById('room-type').textContent = roomTypes[roomType] || roomType;
            }
            
            // Calculate required amount based on room type and duration
            if (checkin && checkout) {
                const checkinDate = new Date(checkin);
                const checkoutDate = new Date(checkout);
                const timeDiff = checkoutDate.getTime() - checkinDate.getTime();
                const nights = Math.ceil(timeDiff / (1000 * 3600 * 24));
                
                let roomPrice = 0;
                if (roomType === 'executive') roomPrice = 299;
                else if (roomType === 'regular') roomPrice = 199;
                else if (roomType === 'full-house') roomPrice = 800; // Default for full house
                else roomPrice = 250; // Default
                
                const requiredAmount = roomPrice * nights;
                document.getElementById('required-amount').textContent = requiredAmount.toFixed(2);
            }
        });
        
        // Function to initiate payment
        async function initiatePayment() {
            const bookingId = new URLSearchParams(window.location.search).get('id');
            const name = new URLSearchParams(window.location.search).get('name');
            const roomType = new URLSearchParams(window.location.search).get('room');
            const requiredAmount = document.getElementById('required-amount').textContent;
            
            if (!bookingId || !name || !roomType) {
                alert('Booking information is incomplete. Please contact support.');
                return;
            }
            
            try {
                const response = await fetch('/initiate-payment', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        booking_id: bookingId,
                        email: '', // Will be retrieved from booking record
                        customer_name: name,
                        room_type: roomType,
                        amount: parseFloat(requiredAmount)
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Redirect to Paystack payment page
                    window.location.href = result.authorization_url;
                } else {
                    alert('Error initiating payment: ' + result.message);
                }
            } catch (error) {
                console.error('Error initiating payment:', error);
                alert('Error initiating payment. Please try again.');
            }
        }
        
        // Function to initiate donation
        async function initiateDonation() {
            const donationAmount = prompt('Enter donation amount (GHS):');
            
            if (!donationAmount) {
                return; // User cancelled
            }
            
            const donationFloat = parseFloat(donationAmount);
            
            if (isNaN(donationFloat) || donationFloat <= 0) {
                alert('Please enter a valid donation amount.');
                return;
            }
            
            try {
                const response = await fetch('/initiate-donation', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: '', // Will be retrieved from user input or booking
                        customer_name: new URLSearchParams(window.location.search).get('name') || 'Anonymous Donor',
                        amount: donationFloat
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Redirect to Paystack donation page
                    window.location.href = result.authorization_url;
                } else {
                    alert('Error initiating donation: ' + result.message);
                }
            } catch (error) {
                console.error('Error initiating donation:', error);
                alert('Error initiating donation. Please try again.');
            }
        }
    </script>
</body>
</html>